# B站视频分析功能使用说明

## 🎬 功能概述

B站视频分析功能是AskAnything插件的新增功能，可以智能分析B站视频内容，提供结构化的摘要和时间戳导航，帮助用户快速了解视频内容并进行精准跳转。

## ✨ 主要特性

- **智能内容分析**：自动提取视频标题、描述和字幕信息
- **多种分析模式**：支持内容摘要、章节划分、重点时刻、完整分析
- **时间戳导航**：生成可点击的时间戳跳转链接
- **关键词聚焦**：支持指定关注关键词进行重点分析
- **多URL格式支持**：兼容各种B站视频链接格式

## 🚀 使用方法

### 1. 前置条件

- 确保已安装AskAnything浏览器插件
- 在选项页面配置通义千问API密钥
- 选择通义千问模型（qwen3）

### 2. 开始分析

1. **打开侧边栏**：点击浏览器工具栏中的AskAnything图标
2. **选择模型**：确保选择了"通义千问"模型
3. **点击多媒体分析**：在聊天控制区域找到"🎭 多媒体分析"按钮并点击
4. **切换到视频分析**：在展开的面板中点击"🎬 视频分析"标签
5. **输入视频链接**：在输入框中粘贴B站视频URL
6. **选择分析类型**（可选）：
   - **内容摘要**：提供视频的简要总结
   - **章节划分**：将视频分成主要章节
   - **重点时刻**：提取关键亮点时刻
   - **完整分析**：包含所有上述内容
7. **设置关注关键词**（可选）：输入你特别关注的关键词
8. **开始分析**：点击"开始分析"按钮

### 3. 支持的URL格式

```
✅ https://www.bilibili.com/video/BV1xx411c7mD
✅ https://b23.tv/BV1xx411c7mD  
✅ https://www.bilibili.com/video/av123456
```

## 📊 分析结果示例

### 内容摘要模式
```
📹 视频分析结果

🎬 标题：《深度学习入门教程》
⏱️ 时长：45:32
👤 UP主：AI学习者

📝 内容摘要：
本视频详细介绍了深度学习的基础概念、神经网络结构和实际应用案例...

🔗 跳转链接：https://www.bilibili.com/video/BV1xx411c7mD
```

### 章节划分模式
```
📚 章节导航：
• [00:00-05:30] 深度学习概述 - 介绍基本概念和发展历史
• [05:30-15:20] 神经网络基础 - 详解神经元和网络结构  
• [15:20-28:45] 反向传播算法 - 核心训练机制讲解
• [28:45-40:10] 实战案例演示 - 图像识别项目实现
• [40:10-45:32] 总结与展望 - 学习建议和发展趋势
```

### 重点时刻模式
```
⭐ 重点时刻：
• [08:15] 神经网络的数学原理解释
• [22:30] 反向传播算法的关键步骤
• [35:20] 代码实现的核心部分
```

## 🔧 技术实现

### 核心组件

1. **BilibiliVideoService**：负责视频信息获取和字幕提取
2. **VideoAnalyzer组件**：提供用户界面和交互
3. **视频理解工具**：集成到自定义工具系统中
4. **AI分析引擎**：使用通义千问进行内容理解

### 数据流程

```
用户输入URL → 解析视频ID → 获取视频信息 → 提取字幕 → AI分析 → 结构化输出
```

### API调用

- **B站视频信息API**：`https://api.bilibili.com/x/web-interface/view`
- **B站字幕API**：`https://api.bilibili.com/x/player/v2`
- **通义千问API**：用于内容分析和理解

## 🛠️ 故障排除

### 常见问题

**Q: 提示"未设置通义千问API密钥"**
A: 请在插件选项页面配置通义千问API密钥

**Q: 无法获取视频信息**
A: 检查视频链接是否正确，确保视频为公开状态

**Q: 没有获取到字幕**
A: 部分视频可能没有字幕，系统会基于标题和描述进行分析

**Q: 分析结果不准确**
A: 可以尝试使用"关注关键词"功能来指导AI重点分析特定内容

### 错误代码

- `VIDEO_ID_PARSE_ERROR`：视频ID解析失败
- `VIDEO_INFO_FETCH_ERROR`：视频信息获取失败
- `SUBTITLE_FETCH_ERROR`：字幕获取失败
- `AI_ANALYSIS_ERROR`：AI分析过程出错

## 🔮 未来计划

- [ ] 支持YouTube视频分析
- [ ] 添加视频下载功能
- [ ] 支持批量视频分析
- [ ] 集成到笔记系统
- [ ] 添加视频摘要导出功能

## 📝 更新日志

### v1.2.1 (2024-12-19)
- 🎭 融合多媒体分析功能，统一图片和视频分析入口
- 📑 新增标签页切换，提供更直观的操作体验
- 🚀 优化主按钮交互，支持直接拖拽图片上传
- 💾 简化界面设计，减少控制元素数量

### v1.2.0 (2024-12-19)
- ✨ 新增B站视频分析功能
- ✨ 支持多种分析模式
- ✨ 实现时间戳跳转
- ✨ 添加关键词聚焦功能
- 🎨 优化用户界面设计

## 🤝 反馈与建议

如果您在使用过程中遇到问题或有改进建议，欢迎通过以下方式反馈：

- 在GitHub仓库提交Issue
- 通过插件选项页面的反馈功能
- 发送邮件至开发团队

---

**注意**：本功能需要网络连接来获取视频信息和调用AI分析服务。请确保网络环境正常。 